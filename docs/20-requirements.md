# 요구사항 정의서

## 1. 목적

- 타로 카드 데이터를 연구/정리하고, 드로우 결과 및 해석(GPT 문장화)을 기록하여 **언제든 재열람**할 수 있게 합니다.
- 앱은 **단일 사용자**, **로컬 퍼스트**를 기본 전제로 합니다.

## 2. 범위

### 2.1 포함 범위

- 카드 목록/상세 조회
- 카드 의미 데이터(키워드/정방향/역방향) 저장 및 표시
- 카드 이미지 표시
  - 기본: SVG 폴백
  - 옵션: 실제 이미지 파일/URL 사용
- 드로우(카드 뽑기) 생성 및 저장
- 기록(History) 목록/상세 재열람
- RWS(이미지) + Waite 텍스트 기반 카드 의미 자동 채움 스크립트

### 2.2 제외 범위

- 인증/권한(로그인)
- 다중 사용자/공유/협업
- 결제/구독

## 3. 이해관계자

- 사용자(Researcher): 단일 사용자(본인)
- 개발자(운영자): 동일 인물(로컬 개발/운영)

## 4. 용어

- **RWS**: Rider–Waite–Smith 타로 덱
- **Waite 텍스트**: A. E. Waite의 *The Illustrated/Pictorial Key to the Tarot* 계열 원문(퍼블릭 도메인 소스 사용)
- **드로우(Draw)**: 특정 날짜/시각에 카드 N장을 뽑은 기록
- **정/역(Upright/Reversed)**: 카드 방향

## 5. 기능 요구사항

### 5.1 카드(Cards)

- **FR-CARDS-001 목록 조회**
  - arcana(MAJOR/MINOR), suit(WANDS/CUPS/SWORDS/PENTACLES), query(검색어)로 필터링할 수 있어야 합니다.
  - 기본 정렬은 `sortKey` 오름차순입니다.
  - 로딩/빈 상태/에러 상태를 제공해야 합니다.

- **FR-CARDS-002 상세 조회**
  - 카드 메타데이터(한/영 이름, arcana, suit, rank)를 보여야 합니다.
  - 카드 의미(키워드, 정방향, 역방향)를 보여야 합니다.

- **FR-CARDS-003 이미지 표시**
  - `thumbnailUrl/imageUrl`이 있으면 해당 이미지를 사용합니다.
  - 없으면 백엔드의 SVG 생성/서빙으로 폴백합니다.

### 5.2 드로우(Draw)

- **FR-DRAW-001 드로우 생성**
  - 카드 N장을 뽑아야 하며, 각 카드의 position(순서)과 orientation(정/역)을 포함해야 합니다.
  - 생성 결과는 저장되어야 합니다.

- **FR-DRAW-002 GPT 리딩 생성**
  - GPT 호출은 **백엔드에서만** 수행합니다.
  - 생성 요청 시 사용된 프롬프트 텍스트와 결과 텍스트는 저장되어야 합니다.

### 5.3 기록(History)

- **FR-HISTORY-001 목록 조회**
  - 날짜/시간 기준으로 목록을 볼 수 있어야 합니다.
  - 로딩/빈 상태/에러 상태를 제공해야 합니다.

- **FR-HISTORY-002 상세 조회**
  - 저장된 드로우 정보(카드 목록/정역/순서)와 GPT 출력(요약/리딩 텍스트)을 재열람할 수 있어야 합니다.
  - 재열람은 “재생성”이 아니라 **저장된 값을 그대로 보여야** 합니다.

### 5.4 데이터 자동 채움(RWS + Waite)

- **FR-IMPORT-001 자동 채움 스크립트**
  - RWS 이미지(78장)와 Waite 텍스트 기반 의미(키워드/정방향/역방향)를 자동으로 채울 수 있어야 합니다.
  - 스크립트는 반복 실행해도 데이터가 망가지지 않도록 **재실행 안전**해야 합니다.

## 6. 비기능 요구사항

### 6.1 UI/UX

- 모바일 퍼스트 반응형
- Tailwind 유틸리티 클래스만 사용(인라인 스타일 지양)
- 톤: calm, mystical, concise (UI 문구에 이모지 지양)

### 6.2 데이터/정합성

- 모든 날짜는 ISO 포맷 문자열(YYYY-MM-DD)을 사용합니다.
- 모든 주요 엔터티는 `createdAt`(및 필요 시 `updatedAt`)을 포함합니다.

### 6.3 운영/로컬 환경

- 로컬에서 실행 가능해야 합니다(local-first).
- 환경변수는 단일 `.env`를 통해 로드합니다.

## 7. 데이터 요구사항(요약)

### 7.1 TarotCard

- 식별자: `id`
- 카드명: `nameEn`, `nameKo`
- 분류: `arcana`, `suit?`, `rank?`, `sortKey`
- 이미지: `thumbnailUrl?`, `imageUrl?`
- 의미: `keywords[]`, `description`, `uprightPoints`, `reversedPoints`
- 타임스탬프: `createdAt`, `updatedAt`

### 7.2 Draw / DrawItem

- Draw: 날짜/시간, 카드 수, 프롬프트/모델/버전, 요약/리딩 텍스트, 아이템 목록
- DrawItem: position, orientation, card reference

## 8. 화면 요구사항(요약)

### 8.1 Home

- 앱 소개 및 주요 기능 진입점 제공

### 8.2 Cards

- 목록: 검색/필터/그리드
- 상세: 이미지 + 의미 + 메타

### 8.3 Draw

- 카드 수 선택/뽑기/저장
- GPT 리딩 생성(로딩/에러 포함)

### 8.4 History

- 목록: 날짜/시간/요약
- 상세: 카드 목록 + 리딩 텍스트


